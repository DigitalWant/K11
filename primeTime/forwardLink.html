<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <title>盛时表行</title>
        <meta name="description" content="">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,minimal-ui">
        <meta http-equiv="cleartype" content="on">
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/animate.min.css">
        <script type="text/javascript">
            window.addEventListener('touchmove', function(e) {
              e.preventDefault();

                media.audio_init();
                media.audio_play();

            }, false);

        </script>
        <script src="js/vendor/modernizr-2.8.3.min.js"></script>
        <script src="js/vendor/jquery-2.1.1.min.js"></script>
         <script src="js/vendor/d3.v3.min.js"></script>
        <script src="js/vendor/jquery.imgpreload.min.js"></script>
        <script src="js/vendor/loader.js"></script>
    </head>
    <body >
    
  <!-- 声音控件 
  <div class='u-audio ' data-src='music.mp3'>
    <p class="btn_audio">
      <strong class='txt_audio z-hide'>关闭</strong>
      <span class='audio_open'></span>
    </p>
  </div>-->
  <!-- 声音控件 end-->
<div id="audio" style="position:fixed;z-index:99999;width:300px;height:140px;right:0px;top:0px; left:auto; background:#000;" data-src="music.mp3">
</div>

 <script type="text/javascript">

var media = {

    _audioNode      : $('#audio'),                        // 声音模块
    _audio          : null,                                 // 声音对象
    _audio_val      : true,                                 // 声音是否开启控制

// 声音初始化
    audio_init : function(){
        // media资源的加载
        var options_audio = {
            loop: true,
            preload: "auto",
            src: media._audioNode.attr('data-src')
        }
        
        media._audio = new Audio(); 

        for(var key in options_audio){
            if(options_audio.hasOwnProperty(key) && (key in media._audio)){
                media._audio[key] = options_audio[key];
            }
        }
        media._audio.load();
    },

    // 声音事件绑定
    audio_addEvent : function(){
        if(media._audioNode.length<=0) return;

        // 声音按钮点击事件
        var txt = media._audioNode.find('.txt_audio'),
            time_txt = null;
        media._audioNode.find('.btn_audio').on('click',media.audio_contorl);

        // 声音打开事件
        $(media._audio).on('play',function(){
            media._audio_val = false;

            audio_txt(txt,true,time_txt);
            $('.audio_open').removeClass('audio_close');
            
            // 开启音符冒泡
            //$.fn.coffee.start();
            //$('.coffee-steam-box').show(500);
        })

        // 声音关闭事件
        $(media._audio).on('pause',function(){
            audio_txt(txt,false,time_txt)
            $('.audio_open').addClass('audio_close');
            
            // 关闭音符冒泡
            //$.fn.coffee.stop();
            //$('.coffee-steam-box').hide(500);
        })

        function audio_txt(txt,val,time_txt){
            if(val) txt.text('打开');
            else txt.text('关闭');

            if(time_txt) clearTimeout(time_txt);

            txt.removeClass('z-move z-hide');
            time_txt = setTimeout(function(){
                txt.addClass('z-move').addClass('z-hide');
            },1000)
        }
    },

    // 声音控制函数
    audio_contorl : function(){
        if(!media._audio_val){
            media.audio_stop();
        }else{
            media.audio_play();
        }
    },  

    // 声音播放
    audio_play : function(){
        media._audio_val = false;
        if(media._audio) media._audio.play();
    },

    // 声音停止
    audio_stop  : function(){
        media._audio_val = true;
        if(media._audio) media._audio.pause(); 
    }

}

/*
setTimeout(function(){
media.audio_init();
media.audio_play();

},5000)
*/

        </script>




    </body>
</html>
